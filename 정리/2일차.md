# 2일차


## 1. 정적 컨텐츠: html, image 등
- 경로: 프로젝트\src\resources\static(public)\정적컨텐츠 파일
- SpringBoot에서 실행하는 것이 아닌 브라우저에 전달하여, 브라우저에서 실행됨.


## 2. View: 템플릿엔진(Thymeleaf), 서블릿, JSP 파일 등
- 요청 시 SpringBoot의 실행 순서에 따라 호출
- D.S <--> Handler Mapping <--> Handler Adapter <--> Controller  
  <--> View Resolver <--> View Return
- 뷰를 실행한 결과를 브라우저에 반환


## 실습
- http://localhost:8080/spring
- /spring = 컨텍스트 패스 ---> SpringController.java가 작업
- SpringController.java의 실행 결과 = Hello~Spring!!


## @Requestparam 객체를 통해 데이터 전송 -> Member 객체 생성
- MemberController.java
```

package com.sch.springboot.controller;

import com.sch.springboot.dto.Member;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class MemberController {

    @GetMapping("/member")
    public String member(@RequestParam("name") String name,
                         @RequestParam("age") int age,
                         @RequestParam("address") String address,
                         Model model){

//        // 브라우저에서 받은 데이터 터미널에 출력
//        System.out.println(name);
//        System.out.println(age);
//        System.out.println(address);

        // Meber Class로 관리하기
        Member member = new Member();
        member.setName(name);
        member.setAge(age);
        member.setAddress(address);

        // model에 추가
        // "member" -> "user"로 하면 view에서 member.getName()이 아니라 usesr.getName()이어야 함.
        model.addAttribute("member", member);



        return "member";    // view name + model 객체
    }
}

```


## 파라미터로 전송된 데이터를 @ModelAttribute를 통해 Member 객체 매핑
form에서 넘어오는 이름과 클래스의 필드 이름이 똑같아야 함.
- MemberController.java
```

package com.sch.springboot.controller;

import com.sch.springboot.dto.Member;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class MemberController {

    @GetMapping("/member")
    // Spring에서 parameter를 객체에 저장하는 것을 자동화하기
    public String member(@ModelAttribute Member member, Model model){

        // "member" -> "user"로 하면 view에서 member.getName()이 아니라 usesr.getName()이어야 함.
        model.addAttribute("member", member);

        return "member";    // view name + model 객체
    }
}

```


## 입력폼 --> post로 전송
- MemberController.java
```
package com.sch.springboot.controller;

import com.sch.springboot.dto.Member;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

@Controller
public class MemberController {
    // get이면 getMapping, post면 postMapping을 알아서 함.
    @PostMapping("/member")
    public String memberPost(@ModelAttribute Member member, Model model){
        System.out.println("Post!");
        model.addAttribute("member", member);
        return "member";
    }

    @ResponseBody
    @PostMapping("/member-api")
    public Member memberApi(@ModelAttribute Member member){
        return member;    // Rest Api
    }
}
```


## 로그인, 회원가입 - DTO, Controller, Service, Repository
- User.java
```
package com.sch.springboot.dto;

public class User {
    private String id;      // 아이디
    private String pass;    // 비밀번호
    private String name;    // 이름
    private String email;   // 이메일

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getPass() {
        return pass;
    }

    public void setPass(String pass) {
        this.pass = pass;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }
}

```

- UserController.java
```
package com.sch.springboot.controller;

import com.sch.springboot.dto.User;
import com.sch.springboot.service.UserService;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import java.util.Map;
import java.util.Objects;

@Controller
public class UserController {
    // @ModelAttribute는 생략 가능
    // Controller가 Service를 호출해야 함.
    UserService userService = new UserService();

    // 로그인
    @ResponseBody
    @PostMapping("/login")
    public Map<String, Object> login(User user){
        return userService.login(user);
        // name, email은 null이 뜸
    }

    // 회원가입
    @ResponseBody
    @PostMapping("/signup")
    public Map<String, String> signup(User user){
        return userService.signUp(user);
    }
}

```

- UserService.java
```
package com.sch.springboot.service;

import com.sch.springboot.dto.User;
import com.sch.springboot.repository.UserRepository;
import org.springframework.stereotype.Service;

import java.util.Map;

@Service
public class UserService {
    // java method
    // Controller의 데이터를 받음
    UserRepository userRepository = new UserRepository();

    /*
    * login : 로그인 비즈니스 로직 처리
     */
    public Map<String, Object> login(User user){
        // DB에 저장되어 있는 데이터와 Controller에서 받은 데이터가 일치하는지 확인하면 될듯?
        System.out.println("UserService login --->");
        System.out.println(user.getId() + "," + user.getPass());
        return userRepository.login(user);
    }

    /*
    * signUp : 회원가입 비즈니스 로직 처리
     */
    public Map<String, String> signUp(User user){
        return userRepository.signUp(user);
    }
}

```

- UserRepository.java
```
package com.sch.springboot.repository;

import com.sch.springboot.dto.User;
import org.springframework.stereotype.Repository;

import java.util.HashMap;
import java.util.Map;
import java.util.Objects;

@Repository
public class UserRepository {
    /*
    * login : 로그인 처리
     */
    public Map<String, Object> login(User user){
        // DB 이용해야 되는데 없으니까 임시 데이터 생성
        String did = "admin";
        String dpass = "1234";
        // 해시맵 공부하시긔...
        Map<String, Object> result = new HashMap<String, Object>();

        // Repository에서 비교해야 되나봄.
        if(user.getId().equals(did) && user.getPass().equals(dpass)){
            // 로그인 성공(상태, 성공)
            result.put("status", "success");
            result.put("message", "로그인 성공");
            result.put("id", user.getId());

        } else {
            // 로그인 실패
            result.put("status", "fail");
            result.put("message", "로그인 실패");
            result.put("id", user.getId());
        }

        return result;
    }

    /*
    * signUp : 회원가입 처리
     */
    public Map<String, String> signUp(User user){
        Map<String, String> result = new HashMap<String, String>();

        result.put("id", user.getId());
        result.put("pass", user.getPass());
        result.put("name", user.getName());
        result.put("email", user.getEmail());

        return result;
    }
}

```

## 최종 정리
Controller <--> Service <--> Repository 상호작용 공부

